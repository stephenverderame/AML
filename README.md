# AML - Advanced Macro Language
An interpretted preprocessor language. Designed with an LR parser 
The idea is to create a language similar to C's preprocessor that performs more complicated operations at compile time. Some planned features are:
* random numbers
* IO - sockets and files
* string and file processing
* other computations


The project is just in its infancy state and the design is subject to change
As you can see I am terrible at naming things

An example of possible usage could be:
* generating class definitions from JSON or XML
* adding reflection to statically typed languages
* performing computations before sending data to a remote client
* loading data from a file or server "into memory" at compile time


Basically the plan is PHP but more lightweight and abstract. 


## Components
* Interpreter
* Tokenizer
* Parser
* Evaluator

## Interpreter (main)
Parses command line arguments and sets up the input and output streams
Reads each character from the input and checks if it is the designated symbol `"##"`
If so, passes input to the tokenizer, else puts the character on the output stream

## Tokenizer
Utilizes a compile time perfect hash table for token lookup.
The PH is generated by 
1. putting each value into an array where `x = hash % size` and `y = (hash / size) % size`
2. Sliding each row until there is no column in the table with conflicts

Naturally given the name, all computation is done at compile time giving it an O(1) run time cost (Well, really O(m) where m is the length of each read from the input stream)
The tokenizer continues to read for valid input characters, and upon reaching a delimiting character looks up the string in the hash table and returns its numerical token value
The tokenizer will also parse literals but will not resolve variable names

## Parser
The parser takes each token and adds it to the parse tree. The Parser is an LR bottom-up parse tree so it first adds the left child, then the parent, then the right child. The parent then becomes the left child of the next token added. Ex `5 + 3`
```

5 is the root
+ becomes the new root and 5 is the left child
3 becomes the right child of +

```
Following the addition of a new literal (ie `5`, `33.3`, or `"Hello World"`), the parent of that literal is checked to see if it has a higher precedence over one of its children. If so a left or right rotation is done to preserve operator precedence.

When a sub-expression is encountered `(` or `)`, the sub-expression is parsed as if it's its own tree and the root of that tree is added to the main parse tree.

## Evaluator
Finally the evaluator evalutes the parse tree by visiting each node in a post-order DFT. The evaluator will resolve any variable names. It takes as an input a list of tokens in postfix notation and returns a literal token of the type given by the largest input type. So `long + int` will return `long`. (These are the type in the AML language so `long` is represented as a C++ `long long` and `int` is represented as a C++ `long`).



#### More Details Coming Soon
